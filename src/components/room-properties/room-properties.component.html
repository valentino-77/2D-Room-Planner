
@if (selectedElement()) {
    <div class="space-y-6 animate-in fade-in slide-in-from-right-2 duration-300">
      
      <!-- Header -->
      <div class="flex items-center gap-3 pb-4 border-b border-zinc-100">
        <div class="w-10 h-10 rounded-lg bg-zinc-100 flex items-center justify-center text-zinc-500">
            @if(isFurniture()) { 
                <!-- Furniture Icon -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 12V8H6a2 2 0 0 1-2-2c0-1.1.9-2 2-2h12v4"/><path d="M4 6v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V6"/><path d="M12 12v6"/></svg>
            } @else {
                <!-- Wall Icon -->
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 5h14v14H5z"/><path d="M9 5v14"/><path d="M15 5v14"/></svg>
            }
        </div>
        <div>
            <h3 class="text-sm font-semibold text-zinc-900 leading-tight">
                @if(isFurniture()) { {{ selectedAsFurniture.name }} }
                @if(isWall()) { Wall Segment }
            </h3>
            <p class="text-[10px] text-zinc-400 font-mono mt-0.5">
                {{ selectedElement().id.split('_')[1]?.substring(0,8) || 'OBJECT' }}
            </p>
        </div>
      </div>

      <!-- Furniture Properties -->
      @if (isFurniture()) {
        <div class="space-y-5">
           <!-- Appearance Section -->
           <div>
               <h4 class="text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3">Appearance</h4>
               
               <div class="grid grid-cols-1 gap-4">
                   <!-- Color Picker -->
                   <div class="flex items-center justify-between group">
                        <label class="text-xs text-zinc-600 font-medium">Color</label>
                        <div class="relative flex items-center">
                            <input type="color" [value]="selectedAsFurniture.color" (input)="updateColor($event)"
                                class="opacity-0 absolute inset-0 w-full h-full cursor-pointer z-10">
                            <div class="w-6 h-6 rounded-full border border-zinc-200 shadow-sm" [style.background-color]="selectedAsFurniture.color"></div>
                            <div class="w-4 h-4 text-zinc-400 ml-1 group-hover:text-zinc-600 transition-colors">
                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-3 h-3"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path></svg>
                            </div>
                        </div>
                   </div>

                   <!-- Rotation Slider -->
                   <div class="space-y-2">
                        <div class="flex justify-between items-center">
                            <label class="text-xs text-zinc-600 font-medium">Rotation</label>
                            <span class="text-[10px] font-mono bg-zinc-100 px-1.5 rounded text-zinc-600">{{ selectedAsFurniture.rotation }}Â°</span>
                        </div>
                        <input type="range" min="0" max="359" [value]="selectedAsFurniture.rotation" (input)="updateRotation($event)"
                             class="w-full h-1.5 bg-zinc-100 rounded-lg appearance-none cursor-pointer accent-zinc-900 hover:accent-zinc-700 transition-all">
                   </div>
               </div>
           </div>

           <!-- Dimensions Section -->
           <div>
               <h4 class="text-xs font-semibold text-zinc-500 uppercase tracking-wider mb-3">Dimensions</h4>
               <div class="grid grid-cols-2 gap-3">
                    <div class="space-y-1">
                        <label class="text-[10px] text-zinc-500">Width</label>
                        <div class="relative group">
                            <input type="number" [value]="selectedAsFurniture.dimension.width" (input)="updateDimension('width', $event)"
                                class="w-full pl-2 pr-7 py-1.5 text-sm bg-zinc-50 border border-zinc-200 rounded-md focus:bg-white focus:border-zinc-400 focus:outline-none transition-all text-zinc-900 font-medium">
                            <span class="absolute right-2 top-1.5 text-xs text-zinc-400 group-hover:text-zinc-500 pointer-events-none">cm</span>
                        </div>
                    </div>
                    <div class="space-y-1">
                        <label class="text-[10px] text-zinc-500">Depth</label>
                         <div class="relative group">
                            <input type="number" [value]="selectedAsFurniture.dimension.height" (input)="updateDimension('height', $event)"
                                class="w-full pl-2 pr-7 py-1.5 text-sm bg-zinc-50 border border-zinc-200 rounded-md focus:bg-white focus:border-zinc-400 focus:outline-none transition-all text-zinc-900 font-medium">
                            <span class="absolute right-2 top-1.5 text-xs text-zinc-400 group-hover:text-zinc-500 pointer-events-none">cm</span>
                        </div>
                    </div>
               </div>
           </div>
        </div>
      }

      <!-- Wall Properties -->
      @if (isWall()) {
        <div class="space-y-6">
            <!-- Stats -->
            <div class="bg-zinc-50 rounded-lg p-3 border border-zinc-100 flex items-center justify-between">
                <div class="flex items-center gap-2">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-zinc-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 12h-7m0 0H5m7 0V5m0 7v7"/></svg>
                    <span class="text-xs font-medium text-zinc-600">Length</span>
                </div>
                <span class="text-sm font-bold text-zinc-900">{{ (selectedAsWall.length / 80).toFixed(2) }} m</span>
            </div>

             <!-- Connections -->
             <div class="space-y-3">
                 <h4 class="text-xs font-semibold text-zinc-500 uppercase tracking-wider">Connections</h4>
                 
                 <!-- Start Point -->
                 <div class="p-3 rounded-lg border border-zinc-100 bg-white shadow-sm space-y-2">
                     <div class="flex items-center justify-between mb-1">
                         <span class="text-xs font-medium text-zinc-700">Start Point</span>
                         <span class="w-2 h-2 rounded-full" [class]="wallAttachmentState().start ? 'bg-green-500' : 'bg-zinc-300'"></span>
                     </div>
                     <div class="grid grid-cols-2 gap-2">
                        <button (click)="detachEndpoint('start')" 
                            [disabled]="!wallAttachmentState().start"
                            [class.opacity-50]="!wallAttachmentState().start"
                            class="flex justify-center items-center px-2 py-1.5 text-[10px] font-medium rounded border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 hover:border-zinc-300 transition-all">
                            Detach
                        </button>
                        <button (click)="attachEndpoint('start')" 
                             [disabled]="wallAttachmentState().start"
                             [class.opacity-50]="wallAttachmentState().start"
                            class="flex justify-center items-center px-2 py-1.5 text-[10px] font-medium rounded border border-transparent bg-zinc-900 text-white hover:bg-zinc-800 transition-all">
                            Attach
                        </button>
                     </div>
                 </div>

                 <!-- End Point -->
                 <div class="p-3 rounded-lg border border-zinc-100 bg-white shadow-sm space-y-2">
                     <div class="flex items-center justify-between mb-1">
                         <span class="text-xs font-medium text-zinc-700">End Point</span>
                         <span class="w-2 h-2 rounded-full" [class]="wallAttachmentState().end ? 'bg-green-500' : 'bg-zinc-300'"></span>
                     </div>
                     <div class="grid grid-cols-2 gap-2">
                        <button (click)="detachEndpoint('end')" 
                             [disabled]="!wallAttachmentState().end"
                             [class.opacity-50]="!wallAttachmentState().end"
                            class="flex justify-center items-center px-2 py-1.5 text-[10px] font-medium rounded border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 hover:border-zinc-300 transition-all">
                            Detach
                        </button>
                        <button (click)="attachEndpoint('end')" 
                             [disabled]="wallAttachmentState().end"
                             [class.opacity-50]="wallAttachmentState().end"
                            class="flex justify-center items-center px-2 py-1.5 text-[10px] font-medium rounded border border-transparent bg-zinc-900 text-white hover:bg-zinc-800 transition-all">
                            Attach
                        </button>
                     </div>
                 </div>
            </div>
            
            <div class="px-2 py-2 bg-blue-50/50 text-blue-700 text-[10px] rounded border border-blue-100">
                <p class="leading-tight">
                    Attached points move together when you drag walls or corners.
                </p>
            </div>
        </div>
      }

    </div>
  } @else {
    <div class="h-64 flex flex-col items-center justify-center text-zinc-400">
        <div class="w-16 h-16 rounded-2xl bg-zinc-50 flex items-center justify-center mb-3">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 opacity-20" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M15 15l-2 5L9 9l11 4-5 2zm0 0l5 5M7.188 2.239l.777 2.897M5.136 7.965l-2.898-.777M13.95 4.05l-2.122 2.122m-5.657 5.656l-2.12 2.122" />
            </svg>
        </div>
        <span class="text-sm font-medium text-zinc-500">No selection</span>
        <span class="text-xs text-zinc-400 mt-1 text-center px-4">Click on an object to view details</span>
    </div>
  }
